<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Hockey Stat Sheet</title>

<style>
body { font-family: system-ui; margin: 0; }
nav { display: flex; background: #111; color: white; }
nav button { flex: 1; padding: 12px; border: none; background: none; color: white; }
nav button.active { background: #333; }
section { display: none; padding: 12px; }
section.active { display: block; }
input, select, button { margin: 4px 0; padding: 6px; }
.log { border-top: 1px solid #ccc; margin-top: 10px; padding-top: 10px; }
.scoreline { font-size: 18px; margin: 8px 0; }
.row { display:flex; gap:6px; align-items:center; margin:4px 0; }
.hidden { display:none; }
</style>
</head>

<body>

<nav>
  <button data-tab="seasons" class="active">Seasons</button>
  <button data-tab="teams">Teams</button>
  <button data-tab="newgame">New Game</button>
  <button data-tab="game">Game</button>
</nav>

<section id="seasons" class="active">
  <h3>Seasons</h3>
  <input id="seasonName" placeholder="Season name">
  <button id="addSeason">Add Season</button>
  <div id="seasonList"></div>
</section>

<section id="teams">
  <h3>Teams</h3>
  <select id="teamSeason"></select><br>
  <input id="teamName" placeholder="Team name">
  <input id="teamAbbr" placeholder="Abbr">
  <button id="addTeam">Add Team</button>
  <div id="teamList"></div>

  <h4>Roster</h4>
  <select id="rosterTeam"></select><br>
  <input id="playerNum" placeholder="#" style="width:60px">
  <input id="playerName" placeholder="Player name">
  <select id="playerPos">
    <option value="F">Forward</option>
    <option value="D">Defense</option>
    <option value="G">Goalie</option>
  </select>
  <button id="addPlayer">Add Player</button>
  <div id="rosterList"></div>
</section>

<section id="newgame">
  <h3>New Game</h3>
  <select id="ngSeason"></select><br>
  <select id="ngAway"></select>
  <select id="ngAwayG"></select><br>
  <select id="ngHome"></select>
  <select id="ngHomeG"></select><br>
  <button id="startGame">Start Game</button>
</section>

<section id="game">
  <h3 id="gameStatus"></h3>

  <div class="scoreline">
    Score: <span id="scoreAway">0</span> – <span id="scoreHome">0</span><br>
    Shots: <span id="shotsAway">0</span> – <span id="shotsHome">0</span>
  </div>

  <div id="clockBlock">
    <h2 id="clock">20:00</h2>
    <button id="clockToggle">Start / Stop</button>
    <button id="clockPlus">+1 min</button>
  </div>

  <button id="advancePeriod">Advance Period</button>
  <button id="endGame">End Game</button>

  <div class="log" id="eventLog"></div>
</section>

<script>
const $ = id => document.getElementById(id);

const PERIODS = [
  {label:'Period 1', seconds:1200},
  {label:'Period 2', seconds:1200},
  {label:'Period 3', seconds:1200},
  {label:'Overtime', seconds:300},
  {label:'Shootout', seconds:null}
];

const state = {
  seasons: [],
  teams: {},
  rosters: {},
  game: null,
  clock: { seconds:0, running:false, timer:null }
};

/* ---------- Tabs ---------- */
document.querySelectorAll('nav button').forEach(b=>{
  b.onclick = ()=>{
    document.querySelectorAll('nav button').forEach(x=>x.classList.remove('active'));
    document.querySelectorAll('section').forEach(s=>s.classList.remove('active'));
    b.classList.add('active');
    $(b.dataset.tab).classList.add('active');
  };
});

/* ---------- Seasons ---------- */
addSeason.onclick=()=>{
  if(!seasonName.value)return;
  state.seasons.push(seasonName.value);
  state.teams[seasonName.value] ||= [];
  seasonName.value='';
  renderSeasons();
};

function deleteSeason(name){
  if(!confirm(`Delete season "${name}" and all teams?`))return;
  state.seasons = state.seasons.filter(s=>s!==name);
  delete state.teams[name];
  renderSeasons(); renderTeams();
}

function renderSeasons(){
  seasonList.innerHTML='';
  teamSeason.innerHTML=ngSeason.innerHTML='';
  state.seasons.forEach(s=>{
    seasonList.innerHTML+=`<div class="row">${s}
      <button onclick="deleteSeason('${s}')">Delete</button></div>`;
    teamSeason.innerHTML+=`<option>${s}</option>`;
    ngSeason.innerHTML+=`<option>${s}</option>`;
  });
}

/* ---------- Teams ---------- */
addTeam.onclick=()=>{
  const s=teamSeason.value;
  if(!teamName.value||!teamAbbr.value)return;
  state.teams[s].push({name:teamName.value,abbr:teamAbbr.value});
  state.rosters[teamName.value]=[];
  teamName.value=teamAbbr.value='';
  renderTeams();
};

function renderTeams(){
  teamList.innerHTML='';
  rosterTeam.innerHTML=ngHome.innerHTML=ngAway.innerHTML='';
  (state.teams[teamSeason.value]||[]).forEach(t=>{
    teamList.innerHTML+=`${t.name} (${t.abbr})<br>`;
    rosterTeam.innerHTML+=`<option>${t.name}</option>`;
    ngHome.innerHTML+=`<option>${t.name}</option>`;
    ngAway.innerHTML+=`<option>${t.name}</option>`;
  });
}

teamSeason.onchange=renderTeams;

/* ---------- Rosters ---------- */
addPlayer.onclick=()=>{
  const t=rosterTeam.value;
  if(!t)return;
  state.rosters[t].push({
    number:playerNum.value,
    name:playerName.value,
    position:playerPos.value
  });
  playerNum.value=playerName.value='';
  renderRoster();
};

function renderRoster(){
  const t=rosterTeam.value;
  rosterList.innerHTML=(state.rosters[t]||[])
    .map(p=>`#${p.number} ${p.name} (${p.position})`).join('<br>');
}
rosterTeam.onchange=renderRoster;

/* ---------- Game ---------- */
startGame.onclick=()=>{
  state.game={
    home:ngHome.value,
    away:ngAway.value,
    score:{home:0,away:0},
    shots:{home:0,away:0},
    periodIndex:0,
    ended:false
  };
  loadPeriod();
  updateScore();
  document.querySelector('[data-tab="game"]').click();
};

function loadPeriod(){
  const p=PERIODS[state.game.periodIndex];
  gameStatus.textContent=`${p.label} — ${state.game.away} @ ${state.game.home}`;
  if(p.seconds===null){
    clockBlock.classList.add('hidden');
  } else {
    clockBlock.classList.remove('hidden');
    state.clock.seconds=p.seconds;
    renderClock();
  }
}

/* ---------- Clock ---------- */
function renderClock(){
  clock.textContent=
    `${String(Math.floor(state.clock.seconds/60)).padStart(2,'0')}:`+
    `${String(state.clock.seconds%60).padStart(2,'0')}`;
}

clockToggle.onclick=()=>{
  state.clock.running=!state.clock.running;
  if(state.clock.running){
    state.clock.timer=setInterval(()=>{
      if(state.clock.seconds>0){
        state.clock.seconds--; renderClock();
      }
    },1000);
  } else clearInterval(state.clock.timer);
};

clockPlus.onclick=()=>{
  state.clock.seconds=Math.max(0,state.clock.seconds-60);
  renderClock();
};

/* ---------- Period Control ---------- */
advancePeriod.onclick=()=>{
  if(state.game.periodIndex<PERIODS.length-1){
    state.game.periodIndex++;
    loadPeriod();
  }
};

endGame.onclick=()=>{
  state.game.ended=true;
  gameStatus.textContent='Game Ended';
  clearInterval(state.clock.timer);
};

/* ---------- Score ---------- */
function updateScore(){
  scoreHome.textContent=state.game.score.home;
  scoreAway.textContent=state.game.score.away;
  shotsHome.textContent=state.game.shots.home;
  shotsAway.textContent=state.game.shots.away;
}
</script>
</body>
</html>