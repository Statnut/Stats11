<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Hockey Stat Sheet</title>

<style>
body { font-family: system-ui; margin: 0; }
nav { display: flex; background: #111; color: white; }
nav button { flex: 1; padding: 12px; border: none; background: none; color: white; }
nav button.active { background: #333; }
section { display: none; padding: 12px; }
section.active { display: block; }
input, select, button { margin: 4px 0; padding: 6px; }
.log { border-top: 1px solid #ccc; margin-top: 10px; padding-top: 10px; }
.scoreline { font-size: 18px; margin: 8px 0; }
</style>
</head>

<body>

<nav>
  <button data-tab="seasons" class="active">Seasons</button>
  <button data-tab="teams">Teams</button>
  <button data-tab="newgame">New Game</button>
  <button data-tab="game">Game</button>
</nav>

<section id="seasons" class="active">
  <h3>Seasons</h3>
  <input id="seasonName" placeholder="Season name">
  <button id="addSeason">Add Season</button>
  <div id="seasonList"></div>
</section>

<section id="teams">
  <h3>Teams</h3>
  <select id="teamSeason"></select><br>
  <input id="teamName" placeholder="Team name">
  <input id="teamAbbr" placeholder="Abbr">
  <button id="addTeam">Add Team</button>
  <div id="teamList"></div>

  <h4>Roster</h4>
  <select id="rosterTeam"></select><br>
  <input id="playerNum" placeholder="#" style="width:60px">
  <input id="playerName" placeholder="Player name">
  <select id="playerPos">
    <option value="F">Forward</option>
    <option value="D">Defense</option>
    <option value="G">Goalie</option>
  </select>
  <button id="addPlayer">Add Player</button>
  <div id="rosterList"></div>
</section>

<section id="newgame">
  <h3>New Game</h3>
  <select id="ngSeason"></select><br>
  <select id="ngAway"></select>
  <select id="ngAwayG"></select><br>
  <select id="ngHome"></select>
  <select id="ngHomeG"></select><br>
  <button id="startGame">Start Game</button>
</section>

<section id="game">
  <h3 id="gameStatus"></h3>

  <div class="scoreline">
    Score: <span id="scoreAway">0</span> – <span id="scoreHome">0</span><br>
    Shots: <span id="shotsAway">0</span> – <span id="shotsHome">0</span>
  </div>

  <h2 id="clock">20:00</h2>
  <button id="clockToggle">Start / Stop</button>
  <button id="clockPlus">+1 min</button>
  <button id="advancePeriod">Advance Period</button>

  <h3>Add Goal</h3>
  <select id="goalTeam"></select><br>
  <select id="goalScorer"></select><br>
  <select id="goalA1"></select><br>
  <select id="goalA2"></select><br>
  <select id="goalType">
    <option>EV</option>
    <option>PP</option>
    <option>SH</option>
    <option>EN</option>
    <option>PS</option>
  </select><br>
  <button id="recordGoal">Record Goal</button>

  <h3>Add Shot</h3>
  <select id="shotTeam"></select><br>
  <select id="shotPlayer"></select><br>
  <button id="recordShot">Record Shot</button>

  <h3>Add Penalty</h3>
  <select id="penTeam"></select><br>
  <select id="penPlayer"></select><br>
  <select id="penType"></select><br>
  <input id="penMinutes" type="number" value="2" style="width:80px"> minutes<br>
  <button id="recordPenalty">Record Penalty</button>

  <div class="log" id="eventLog"></div>
</section>

<script>
const $ = id => document.getElementById(id);

const penaltyTypes = {
  "Tripping":2,"Slashing":2,"Hooking":2,"Interference":2,"Holding":2,
  "High-sticking":2,"Roughing":2,"Boarding":2,"Charging":2,
  "Cross-checking":2,"Too Many Men":2,"Misconduct":10
};

const state = {
  seasons: [],
  teams: {},
  rosters: {},
  game: null,
  clock: { seconds:1200, running:false, timer:null }
};

/* Tabs */
document.querySelectorAll('nav button').forEach(b=>{
  b.onclick = ()=>{
    document.querySelectorAll('nav button').forEach(x=>x.classList.remove('active'));
    document.querySelectorAll('section').forEach(s=>s.classList.remove('active'));
    b.classList.add('active');
    $(b.dataset.tab).classList.add('active');
  };
});

/* Seasons */
addSeason.onclick=()=>{
  if(!seasonName.value)return;
  state.seasons.push(seasonName.value);
  seasonName.value='';
  seasonList.innerHTML=state.seasons.join('<br>');
  ngSeason.innerHTML=teamSeason.innerHTML=state.seasons.map(s=>`<option>${s}</option>`).join('');
};

/* Teams */
addTeam.onclick=()=>{
  const s=teamSeason.value;
  if(!state.teams[s])state.teams[s]=[];
  state.teams[s].push({name:teamName.value,abbr:teamAbbr.value});
  state.rosters[teamName.value]=[];
  teamName.value=teamAbbr.value='';
  renderTeams();
};
function renderTeams(){
  teamList.innerHTML='';
  rosterTeam.innerHTML=ngHome.innerHTML=ngAway.innerHTML='';
  (state.teams[teamSeason.value]||[]).forEach(t=>{
    teamList.innerHTML+=`${t.name} (${t.abbr})<br>`;
    rosterTeam.innerHTML+=`<option>${t.name}</option>`;
    ngHome.innerHTML+=`<option>${t.name}</option>`;
    ngAway.innerHTML+=`<option>${t.name}</option>`;
  });
}

/* Roster */
addPlayer.onclick=()=>{
  const t=rosterTeam.value;
  state.rosters[t].push({number:playerNum.value,name:playerName.value,position:playerPos.value,shots:0,pim:0});
  playerNum.value=playerName.value='';
  rosterList.innerHTML=state.rosters[t].map(p=>`#${p.number} ${p.name} (${p.position})`).join('<br>');
};

/* Goalies */
function populateGoalies(team,sel){
  sel.innerHTML='';
  (state.rosters[team]||[]).filter(p=>p.position==='G').forEach(g=>sel.innerHTML+=`<option>${g.name}</option>`);
}
ngHome.onchange=()=>populateGoalies(ngHome.value,ngHomeG);
ngAway.onchange=()=>populateGoalies(ngAway.value,ngAwayG);

/* Start Game */
startGame.onclick=()=>{
  state.game={home:ngHome.value,away:ngAway.value,score:{home:0,away:0},shots:{home:0,away:0},period:1};
  resetClock();
  updateScore();
  gameStatus.textContent=`Period 1 — ${state.game.away} @ ${state.game.home}`;
  document.querySelector('[data-tab="game"]').click();
  setupGameSelectors();
};

/* Clock */
function renderClock(){clock.textContent=`${String(Math.floor(state.clock.seconds/60)).padStart(2,'0')}:${String(state.clock.seconds%60).padStart(2,'0')}`;}
function resetClock(){state.clock.seconds=1200;renderClock();}
clockToggle.onclick=()=>{
  state.clock.running=!state.clock.running;
  if(state.clock.running){
    state.clock.timer=setInterval(()=>{if(state.clock.seconds>0){state.clock.seconds--;renderClock();}},1000);
  } else clearInterval(state.clock.timer);
};
clockPlus.onclick=()=>{state.clock.seconds=Math.max(0,state.clock.seconds-60);renderClock();};
advancePeriod.onclick=()=>{state.game.period++;resetClock();gameStatus.textContent=`Period ${state.game.period} — ${state.game.away} @ ${state.game.home}`;};

/* Goals + Shots + Penalties */
function setupGameSelectors(){
  goalTeam.innerHTML=shotTeam.innerHTML=penTeam.innerHTML='<option>Home</option><option>Away</option>';
  goalTeam.onchange=shotTeam.onchange=penTeam.onchange=populatePlayers;
  penType.innerHTML=Object.keys(penaltyTypes).map(p=>`<option>${p}</option>`).join('');
  penType.onchange=()=>penMinutes.value=penaltyTypes[penType.value];
  populatePlayers();
}
function populatePlayers(){
  const teamKey=this?.value==='Away'?'away':'home';
  const team=state.game[teamKey];
  const list=state.rosters[team]||[];
  goalScorer.innerHTML=goalA1.innerHTML=goalA2.innerHTML=shotPlayer.innerHTML=penPlayer.innerHTML='<option></option>'+list.map(p=>`<option>${p.name}</option>`).join('');
}

recordGoal.onclick = () => {
  const teamKey = goalTeam.value === 'Home' ? 'home' : 'away';
  const teamName = state.game[teamKey];
  const teamObj = Object.values(state.teams).flat().find(t => t.name === teamName);
  const abbr = teamObj ? teamObj.abbr : teamName;

  state.game.score[teamKey]++;
  updateScore();

  const scorer = goalScorer.value || 'Unknown';
  const a1 = goalA1.value;
  const a2 = goalA2.value;
  const assists =
    a1 || a2
      ? ` (${[a1, a2].filter(Boolean).join(', ')})`
      : '';

  eventLog.innerHTML +=
    `${clock.textContent} P${state.game.period} ${abbr} ${scorer}${assists} ${goalType.value}<br>`;
};

recordShot.onclick=()=>{state.game.shots[shotTeam.value==='Home'?'home':'away']++;updateScore();};
recordPenalty.onclick=()=>{
  const teamKey=penTeam.value==='Home'?'home':'away';
  const team=state.game[teamKey];
  const p=state.rosters[team].find(x=>x.name===penPlayer.value);
  if(p)p.pim+=Number(penMinutes.value);
  eventLog.innerHTML+=`${clock.textContent} P${state.game.period} PEN ${penPlayer.value} ${penType.value} ${penMinutes.value}m<br>`;
};

function updateScore(){
  scoreHome.textContent=state.game.score.home;
  scoreAway.textContent=state.game.score.away;
  shotsHome.textContent=state.game.shots.home;
  shotsAway.textContent=state.game.shots.away;
}
</script>
</body>
</html>